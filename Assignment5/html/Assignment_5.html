
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Numerical Analysis Homework 5</title><meta name="generator" content="MATLAB 8.2"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-03-24"><meta name="DC.source" content="Assignment_5.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, tt, code { font-size:12px; }
pre { margin:0px 0px 20px; }
pre.error { color:red; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Numerical Analysis Homework 5</h1><!--introduction--><p>Ryan DeJesus, Daniel Gollahon, Ron Quan</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Review 4.1</a></li><li><a href="#2">Review 4.2</a></li><li><a href="#3">Review 4.3</a></li><li><a href="#4">Review 4.4</a></li><li><a href="#5">Review 4.6</a></li><li><a href="#6">Exercise 4.1</a></li><li><a href="#8">Exercise 4.2</a></li><li><a href="#9">Exercise 4.3</a></li><li><a href="#19">Exercise 4.5</a></li><li><a href="#20">Exercise 4.8</a></li><li><a href="#22">Computer Problem 4.2</a></li><li><a href="#27">Computer Problem 4.3</a></li></ul></div><h2>Review 4.1<a name="1"></a></h2><p>True [p. 161, para 1]</p><h2>Review 4.2<a name="2"></a></h2><p>False [p. 159, para 2]</p><h2>Review 4.3<a name="3"></a></h2><p>False  [i.e. any vector is an eigenvector with an eigenvalue of one if the matrix is the identity matrix]</p><h2>Review 4.4<a name="4"></a></h2><p>False [see example 4.9 for one instance]</p><h2>Review 4.6<a name="5"></a></h2><p>True</p><h2>Exercise 4.1<a name="6"></a></h2><p>(a) Prove that 5 is an eigenvalue of the matrix</p><pre class="codeinput">A = [6 3 3 1; 0 7 4 5; 0 0 5 4; 0 0 0 8];
result = eig(A);
disp(<span class="string">'5 is in the following vector containing the real eigenvalues of matrix A:'</span>);
disp(result);
</pre><pre class="codeoutput">5 is in the following vector containing the real eigenvalues of matrix A:
     6
     7
     5
     8

</pre><p>(b) Exhibit an eigenvector of A corresponding to the eigenvalue 5 To answer this problem, we must solve Ax = 5*x = (A-5*eye(4))x = 0</p><pre class="codeinput">[A,B] = eig(A)
AL = A - 5*eye(4);
result = null(AL);
disp(<span class="string">'Eigenvector corresponding to eigenvector 5:'</span>);
disp(result);
</pre><pre class="codeoutput">
A =

    1.0000    0.9487    0.8018    0.8645
         0    0.3162   -0.5345    0.4963
         0         0    0.2673    0.0640
         0         0         0    0.0480


B =

     6     0     0     0
     0     7     0     0
     0     0     5     0
     0     0     0     8

Eigenvector corresponding to eigenvector 5:
</pre><h2>Exercise 4.2<a name="8"></a></h2><p>What are the eigenvalues and corresponding eigenvectors of the following matrix?</p><pre class="codeinput">A = [ 1 2 -4; 0 2 1; 0 0 3];
disp(<span class="string">'Eigen Values:'</span>);
eig(A)
disp(<span class="string">'Eigen Vectors are the columns of vector V:'</span>);
[V,D] = eig(A);
disp(V);
</pre><pre class="codeoutput">Eigen Values:

ans =

     1
     2
     3

Eigen Vectors are the columns of vector V:
    1.0000    0.8944   -0.5774
         0    0.4472    0.5774
         0         0    0.5774

</pre><h2>Exercise 4.3<a name="9"></a></h2><p><img src="Assignment_5_eq60234.png" alt="$(a)\ det(A- \lambda I) = (1- \lambda )(1- \lambda )-4 = 0$"></p><pre class="codeinput"><span class="comment">% = (1-$\lambda$)^2 - 4 = 0</span>
<span class="comment">%</span>
</pre><p>(b) <img src="Assignment_5_eq23351.png" alt="$\lambda$"> = -1,3</p><p>(c) What are the eigenvalues of A?</p><pre class="codeinput">A = [1 4; 1 1];
eig(A)
</pre><pre class="codeoutput">
ans =

    3.0000
   -1.0000

</pre><p>(d) What are the eigenvectors of A?</p><pre class="codeinput">[v,~] = eig(A);
disp( <span class="string">'Eigen Vectors of A are the column of the following matrix: '</span> )
disp(v)
</pre><pre class="codeoutput">Eigen Vectors of A are the column of the following matrix: 
    0.8944   -0.8944
    0.4472    0.4472

</pre><p>(e) Perform one iteration of power iteration on A using <img src="Assignment_5_eq69357.png" alt="$x_0$"> = [1 1]'</p><pre class="codeinput">x0 = [1 1]';

<span class="comment">% The following is used for normalized power iteration:</span>
x1 = A*x0;
LAMBDA = norm(x1);
x1 = x1 / LAMBDA;
disp(x1);
</pre><pre class="codeoutput">    0.9285
    0.3714

</pre><p>(f) To what eigenvector of A will power iteration ultimately converge?</p><pre class="codeinput">[v,d] = eig(A);
</pre><p>The power iteration will converge to the eigenvector corresponding to the dominant eigenvalue (3) which is the eigenvector below.</p><pre class="codeinput">disp(v(1:end,1));
</pre><pre class="codeoutput">    0.8944
    0.4472

</pre><p>(h) To what eigenvector of A would inverse iteration ultimately converge?</p><p>The inverse iteration converges to the eigenvector corresponding to the smallest eigenvalue of A (-1). [see p.166, last sentence.]</p><pre class="codeinput">disp(v(1:end,2));
</pre><pre class="codeoutput">   -0.8944
    0.4472

</pre><p>(i) What eigen value of A would be obtained if inverse iteration were used with shift <img src="Assignment_5_eq50669.png" alt="$\sigma = 2$">?</p><p>Inverse iteration with a shift of 2 will eventually converge on the eigenvalue of 3 because the process approaches the eigenvalue closest to the shift.</p><h2>Exercise 4.5<a name="19"></a></h2><pre>(a)</pre><pre>Matrix A &amp; row sums:
|a11 a12 . . a1n| row1 sum = a11 + ... + a1n = alpha
|a21 .  .  . a2n| ...
| .  .  .  .  . | ...
| .  .  .  .  . | ...
|an1 .  .  . ann| rown sum = an1 + ... + ann = alpha</pre><pre>A*x:
|a11 a12 . . a1n| | x1| = a11*x1 + ... + a1n*x1 = (a11 + ... + a1n)*x1 = alpha*x1
|a21 .  .  . a2n| | x2| = a21*x2 + ... + a2n*x2 = (a21 + ... + a2n)*x2 = alpha*x2
| .  .  .  .  . | | . | ...
| .  .  .  .  . | | . | ...
|an1 .  .  . ann| | xn| = an1*xn + ... + ann*x2 = (an1 + ... + ann)*xn = alpha*xn</pre><pre>A*x is equivalent to...
alpha*x1     =           | x1|
alpha*x2     =           | x2|
...          =  alpha *  | . |   =&gt; Ax = alpha*x, which is the
alpha*xn-1   =           | . |           definition of an eigenvalue
alpha*xn     =           | xn|</pre><pre>(b)</pre><pre>The eigenvector would be:
|1|     | x1|
|.|     | . |
|.|  =  | . |
|.|     | . |
|1|     | xn|</pre><h2>Exercise 4.8<a name="20"></a></h2><p>A similarity transformation uses a non-singular matrix T to diagonalize some matrix A. We know T must be non-singular because the transformation involves T^-1 and only non-singular matrices are invertible. From that we can see:</p><pre>T^-1*A*T = T^-1*A[x1|x2|...|xn]
         = T^-1*[Ax1|Ax2|...|Axn]
         = T^-1*[lambda1*x1|labda2*x2|...|lambdan*xn]
         = T^-1*[lambda1*(T*e1)|labda2*(T*e2)|...|lambdan*(T*en)]
         = T^-1*[T*(lambda1*e1)|T*(labda2*e2)|...|T*(lambdan*en)]
         = T^-1*T*[lambda1*e1|lambda1*e2|...|lambdan*en]
         = In*[lambda1*e1|lambda1*e2|...|lambdan*en]
         = [lambda1*e1|lambda1*e2|...|lambdan*en]
         = D
(note: e is the standard unit vector)</pre><pre>Since T^-1*A*T = D
AT = DT, since all column of T are linearly independent (because it is
non-singular ) this means the columns of T are eigenvectors with
eigenvalues in D, so there are n linearly independent eigenvectors and this
means the matrix can be transformed using a similarity transformation.</pre><h2>Computer Problem 4.2<a name="22"></a></h2><p>(a) Implement power iteration to compute the dominant eigenvalue and a corresponding eigenvector of the matrix A:</p><p>function [ x, LAMBDA] = Power_it( A,x )</p><pre>  [m,n] = size(A);
  %x = rand(m,1);
  for i = 1:500
      x = A*x;
      LAMBDA = norm(x);
      x = x/LAMBDA;
  end%for</pre><pre>  x;
  LAMBDA;
end</pre><pre class="codeinput">A = [2 3 2; 10 3 4; 3 6 1];
x0 = [0 0 1]';
[first_eig_vec_answer, first_eig_val_answer ] = Power_it(A,x0);
disp(<span class="string">'The dominant eigenvalue:'</span>);
disp(first_eig_val_answer);
disp(<span class="string">'The eigenvector corresponding to the dom eigenvalue:'</span>);
disp(first_eig_vec_answer);
</pre><pre class="codeoutput">The dominant eigenvalue:
   11.0000

The eigenvector corresponding to the dom eigenvalue:
    0.3714
    0.7428
    0.5571

</pre><p>(b) Using any of the method for deflation given in Section 4.5.4, deflate out the eigenvalue found in part a</p><pre class="codeinput">H = House_matrix(first_eig_vec_answer);
H*first_eig_vec_answer;
Eig_Diag_Matrx = H*A*inv(H);
</pre><p>Applying power iteration again to compute the second largest eigenvalue of the same matrix Refer to page 179 for help</p><pre class="codeinput">B = Eig_Diag_Matrx(2:end,2:end);
x0 = rand(2,1);
[second_eig_vec_answer, second_eig_val_answer] = Power_it(B,x0);

<span class="comment">% second_eig_vec_answer = V(:,1)</span>
<span class="comment">% second_eig_val_answe = D(1)</span>

disp(<span class="string">'The second largest absolute eigenvalue is:'</span>);
disp(second_eig_val_answer);

bT = Eig_Diag_Matrx(1,2:end);

alpha_num = bT*second_eig_vec_answer;
alpha_den = second_eig_val_answer - first_eig_val_answer;

alpha = alpha_num/alpha_den;
right_matrix = [alpha; second_eig_vec_answer];
x2 = inv(H)*right_matrix;
</pre><pre class="codeoutput">The second largest absolute eigenvalue is:
    3.0000

</pre><pre class="codeinput">disp(<span class="string">'To enhance accuracy, the second eigenvalue and eigenvector found from the newly deflated matrix '</span>);
disp(<span class="string">'is refined using inverse iteration on the original matirix with a shift equal to the approximate eigenvalue found from earlier calculations.'</span>);
disp(<span class="string">'.'</span>);
disp(<span class="string">'The eigenvector corresponding to the second largest absolute eigenvalue is:'</span>);
[x2, second_eig_val_answer] = Inv_power_it(A,x2,second_eig_val_answer );
x2 = -1 * x2
</pre><pre class="codeoutput">To enhance accuracy, the second eigenvalue and eigenvector found from the newly deflated matrix 
is refined using inverse iteration on the original matirix with a shift equal to the approximate eigenvalue found from earlier calculations.
.
The eigenvector corresponding to the second largest absolute eigenvalue is:

x2 =

    0.0000
   -0.5547
    0.8321

</pre><p>(c) Use a general real eigensystem library routine to compute all of the eigenvalues and eigenvectors of the matrix, and compare the results with those obtained in parts a and b</p><pre class="codeinput">[eig_vectors eig_values] = eig(A);

disp(<span class="string">'First largest absolute eigenvalue produced from eig(A):'</span>);
disp(eig_values(1,1));
disp(<span class="string">'First dominant eigenvalue produced from our power iteration calculation:'</span>);
disp(first_eig_val_answer);

disp(<span class="string">'Vector corresponding to second largest absolute eigenvalue produced from eig(A):'</span>);
disp(eig_vectors(1:end,1));
disp(<span class="string">'Vector corresponding to second dominant eigenvalue produced from our power iteration calculation:'</span>);
disp(first_eig_vec_answer);

disp(<span class="string">'Second largest absolute eigenvalue produced from eig(A):'</span>);
disp(abs(eig_values(3,3)));
disp(<span class="string">'Second dominant eigenvalue produced from our power iteration calculation:'</span>);
disp(second_eig_val_answer);

disp(<span class="string">'Vector corresponding to second largest absolute eigenvalue produced from eig(A):'</span>);
disp(eig_vectors(1:end,3));
disp(<span class="string">'Vector corresponding to second dominant eigenvalue produced from our power iteration calculation:'</span>);
disp(x2);
</pre><pre class="codeoutput">First largest absolute eigenvalue produced from eig(A):
   11.0000

First dominant eigenvalue produced from our power iteration calculation:
   11.0000

Vector corresponding to second largest absolute eigenvalue produced from eig(A):
    0.3714
    0.7428
    0.5571

Vector corresponding to second dominant eigenvalue produced from our power iteration calculation:
    0.3714
    0.7428
    0.5571

Second largest absolute eigenvalue produced from eig(A):
    3.0000

Second dominant eigenvalue produced from our power iteration calculation:
    3.0000

Vector corresponding to second largest absolute eigenvalue produced from eig(A):
   -0.0000
   -0.5547
    0.8321

Vector corresponding to second dominant eigenvalue produced from our power iteration calculation:
    0.0000
   -0.5547
    0.8321

</pre><h2>Computer Problem 4.3<a name="27"></a></h2><p>a) Implementing inverse iteration to find the eigenvector and corresponding eigenvalue closest to 2</p><pre class="codeinput">A = [6 2 1; 2 3 1; 1 1 1];
x = rand(3,1); <span class="comment">%arbitrary starting vector</span>
<span class="keyword">for</span> k = 1:5 <span class="comment">% 5 iterations</span>
    shift = 2; <span class="comment">%using 2 as our shift value</span>
    x = (A - eye(3)*shift) \ x; <span class="comment">%compute the next iteration of the vector</span>
    x = x / norm(x); <span class="comment">%normalizing</span>
<span class="keyword">end</span>
eigenvector = x
lambda = norm(A*x) / norm(x)

<span class="comment">%</span>
<span class="comment">%  b) Calculating eigenvectors/values using a library routine.</span>
[V,D] = eig(A)
</pre><pre class="codeoutput">
eigenvector =

   -0.4974
    0.8196
    0.2843


lambda =

    2.1331


V =

   -0.0432   -0.4974   -0.8664
   -0.3507    0.8196   -0.4531
    0.9355    0.2843   -0.2098


D =

    0.5789         0         0
         0    2.1331         0
         0         0    7.2880

</pre><pre>The calculated eigenvalue/eigenvector appears to be the same with the
amount of precision shown. The values converged quickly to the correct
output when using inverse iteration.</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2013b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Numerical Analysis Homework 5
% Ryan DeJesus,
% Daniel Gollahon,
% Ron Quan
%% Review 4.1
% True [p. 161, para 1]

%% Review 4.2
% False [p. 159, para 2]

%% Review 4.3
% False  [i.e. any vector is an eigenvector with an eigenvalue of one if the matrix is the identity matrix]

%% Review 4.4
% False [see example 4.9 for one instance]

%% Review 4.6
% True 

%% Exercise 4.1
% (a) Prove that 5 is an eigenvalue of the matrix
A = [6 3 3 1; 0 7 4 5; 0 0 5 4; 0 0 0 8];
result = eig(A);
disp('5 is in the following vector containing the real eigenvalues of matrix A:');
disp(result);
%%
% (b) Exhibit an eigenvector of A corresponding to the eigenvalue 5
% To answer this problem, we must solve Ax = 5*x = (A-5*eye(4))x = 0
[A,B] = eig(A)
AL = A - 5*eye(4);
result = null(AL);
disp('Eigenvector corresponding to eigenvector 5:');
disp(result);
%% Exercise 4.2
% 
% What are the eigenvalues and corresponding eigenvectors of the following
% matrix?
A = [ 1 2 -4; 0 2 1; 0 0 3];
disp('Eigen Values:');
eig(A)
disp('Eigen Vectors are the columns of vector V:');
[V,D] = eig(A);
disp(V);
%% Exercise 4.3
%
%%
% $(a)\ det(A- \lambda I) = (1- \lambda )(1- \lambda )-4 = 0$

% = (1-$\lambda$)^2 - 4 = 0
%
%%
% (b) $\lambda$ = -1,3
%
%%
% (c) What are the eigenvalues of A?
A = [1 4; 1 1];
eig(A)
%%
% (d) What are the eigenvectors of A?
[v,~] = eig(A);
disp( 'Eigen Vectors of A are the column of the following matrix: ' )
disp(v)
%%
% (e) Perform one iteration of power iteration on A using $x_0$ = [1 1]'
%
x0 = [1 1]';

% The following is used for normalized power iteration:
x1 = A*x0;
LAMBDA = norm(x1);
x1 = x1 / LAMBDA;
disp(x1);

%%
% (f) To what eigenvector of A will power iteration ultimately converge?
[v,d] = eig(A);

%%
% The power iteration will converge to the eigenvector corresponding to the
% dominant eigenvalue (3) which is the eigenvector below.

disp(v(1:end,1));

%%
% (h) To what eigenvector of A would inverse iteration ultimately converge?
%
% The inverse iteration converges to the eigenvector corresponding to the 
% smallest eigenvalue of A (-1). [see p.166, last sentence.]

disp(v(1:end,2));
%%
% (i) What eigen value of A would be obtained if inverse iteration were used with shift $\sigma = 2$?
%
% Inverse iteration with a shift of 2 will eventually converge on the
% eigenvalue of 3 because the process approaches the eigenvalue closest to
% the shift.

%% Exercise 4.5
%  (a)
%  
%  Matrix A & row sums:
%  |a11 a12 . . a1n| row1 sum = a11 + ... + a1n = alpha 
%  |a21 .  .  . a2n| ...
%  | .  .  .  .  . | ...
%  | .  .  .  .  . | ...
%  |an1 .  .  . ann| rown sum = an1 + ... + ann = alpha
%
%  A*x:
%  |a11 a12 . . a1n| | x1| = a11*x1 + ... + a1n*x1 = (a11 + ... + a1n)*x1 = alpha*x1
%  |a21 .  .  . a2n| | x2| = a21*x2 + ... + a2n*x2 = (a21 + ... + a2n)*x2 = alpha*x2
%  | .  .  .  .  . | | . | ...
%  | .  .  .  .  . | | . | ...
%  |an1 .  .  . ann| | xn| = an1*xn + ... + ann*x2 = (an1 + ... + ann)*xn = alpha*xn
%
%  A*x is equivalent to... 
%  alpha*x1     =           | x1|
%  alpha*x2     =           | x2|
%  ...          =  alpha *  | . |   => Ax = alpha*x, which is the
%  alpha*xn-1   =           | . |           definition of an eigenvalue
%  alpha*xn     =           | xn|
%
%  (b)
%  
%  The eigenvector would be:
%  |1|     | x1|
%  |.|     | . |
%  |.|  =  | . |
%  |.|     | . |
%  |1|     | xn|

%% Exercise 4.8
% A similarity transformation uses a non-singular matrix T to diagonalize
% some matrix A. We know T must be non-singular because the transformation
% involves T^-1 and only non-singular matrices are invertible. From that we
% can see:

%%
%  T^-1*A*T = T^-1*A[x1|x2|...|xn]
%           = T^-1*[Ax1|Ax2|...|Axn]
%           = T^-1*[lambda1*x1|labda2*x2|...|lambdan*xn]
%           = T^-1*[lambda1*(T*e1)|labda2*(T*e2)|...|lambdan*(T*en)]
%           = T^-1*[T*(lambda1*e1)|T*(labda2*e2)|...|T*(lambdan*en)]
%           = T^-1*T*[lambda1*e1|lambda1*e2|...|lambdan*en]
%           = In*[lambda1*e1|lambda1*e2|...|lambdan*en]
%           = [lambda1*e1|lambda1*e2|...|lambdan*en]
%           = D
%  (note: e is the standard unit vector)
%
%  Since T^-1*A*T = D
%  AT = DT, since all column of T are linearly independent (because it is
%  non-singular ) this means the columns of T are eigenvectors with
%  eigenvalues in D, so there are n linearly independent eigenvectors and this 
%  means the matrix can be transformed using a similarity transformation.


%% Computer Problem 4.2
%
% (a) Implement power iteration to compute the dominant eigenvalue and a
% corresponding eigenvector of the matrix A:
%
% function [ x, LAMBDA] = Power_it( A,x )
%
%    [m,n] = size(A);
%    %x = rand(m,1);
%    for i = 1:500
%        x = A*x;
%        LAMBDA = norm(x);
%        x = x/LAMBDA;
%    end%for
%    
%    x;
%    LAMBDA;
% end
A = [2 3 2; 10 3 4; 3 6 1];
x0 = [0 0 1]';
[first_eig_vec_answer, first_eig_val_answer ] = Power_it(A,x0);
disp('The dominant eigenvalue:');
disp(first_eig_val_answer);
disp('The eigenvector corresponding to the dom eigenvalue:');
disp(first_eig_vec_answer);

%%
%
%
% (b) Using any of the method for deflation given in Section 4.5.4, deflate out the eigenvalue found in part a

H = House_matrix(first_eig_vec_answer);
H*first_eig_vec_answer;
Eig_Diag_Matrx = H*A*inv(H);
%% 
% Applying power iteration again to compute the second largest eigenvalue of the same matrix
% Refer to page 179 for help

B = Eig_Diag_Matrx(2:end,2:end);
x0 = rand(2,1);
[second_eig_vec_answer, second_eig_val_answer] = Power_it(B,x0);

% second_eig_vec_answer = V(:,1)
% second_eig_val_answe = D(1)

disp('The second largest absolute eigenvalue is:');
disp(second_eig_val_answer);

bT = Eig_Diag_Matrx(1,2:end);

alpha_num = bT*second_eig_vec_answer;
alpha_den = second_eig_val_answer - first_eig_val_answer;

alpha = alpha_num/alpha_den;
right_matrix = [alpha; second_eig_vec_answer];
x2 = inv(H)*right_matrix;


%%
disp('To enhance accuracy, the second eigenvalue and eigenvector found from the newly deflated matrix ');
disp('is refined using inverse iteration on the original matirix with a shift equal to the approximate eigenvalue found from earlier calculations.');
disp('.');
disp('The eigenvector corresponding to the second largest absolute eigenvalue is:');
[x2, second_eig_val_answer] = Inv_power_it(A,x2,second_eig_val_answer );
x2 = -1 * x2
%%
% (c) Use a general real eigensystem library routine to compute all of the
% eigenvalues and eigenvectors of the matrix, and compare the results with
% those obtained in parts a and b
[eig_vectors eig_values] = eig(A);

disp('First largest absolute eigenvalue produced from eig(A):');
disp(eig_values(1,1));
disp('First dominant eigenvalue produced from our power iteration calculation:');
disp(first_eig_val_answer);

disp('Vector corresponding to second largest absolute eigenvalue produced from eig(A):');
disp(eig_vectors(1:end,1));
disp('Vector corresponding to second dominant eigenvalue produced from our power iteration calculation:');
disp(first_eig_vec_answer);

disp('Second largest absolute eigenvalue produced from eig(A):');
disp(abs(eig_values(3,3)));
disp('Second dominant eigenvalue produced from our power iteration calculation:');
disp(second_eig_val_answer);

disp('Vector corresponding to second largest absolute eigenvalue produced from eig(A):');
disp(eig_vectors(1:end,3));
disp('Vector corresponding to second dominant eigenvalue produced from our power iteration calculation:');
disp(x2);

%% Computer Problem 4.3
%
% a) Implementing inverse iteration to find the eigenvector and corresponding
% eigenvalue closest to 2

A = [6 2 1; 2 3 1; 1 1 1];
x = rand(3,1); %arbitrary starting vector
for k = 1:5 % 5 iterations
    shift = 2; %using 2 as our shift value
    x = (A - eye(3)*shift) \ x; %compute the next iteration of the vector
    x = x / norm(x); %normalizing
end
eigenvector = x
lambda = norm(A*x) / norm(x)

%
%  b) Calculating eigenvectors/values using a library routine.
[V,D] = eig(A)

%%
%  The calculated eigenvalue/eigenvector appears to be the same with the
%  amount of precision shown. The values converged quickly to the correct
%  output when using inverse iteration.


##### SOURCE END #####
--></body></html>